(this["webpackJsonpsocket-chat"]=this["webpackJsonpsocket-chat"]||[]).push([[0],{51:function(e,t,n){},52:function(e,t,n){},89:function(e,t,n){"use strict";n.r(t);var s=n(0),c=n.n(s),i=n(19),r=n.n(i),o=(n(51),n(16)),u=(n(52),n(9)),a=n(31),l=n(6),d=n(45),j={socket:null,createConnection:function(){this.socket=Object(d.io)("http://localhost:3500/")},subscribe:function(e,t,n){var s,c,i;null===(s=this.socket)||void 0===s||s.on("init-messages-published",e),null===(c=this.socket)||void 0===c||c.on("new-message-sent",t),null===(i=this.socket)||void 0===i||i.on("user-typing",n)},destroyConnection:function(){var e;null===(e=this.socket)||void 0===e||e.disconnect(),this.socket=null},sendName:function(e){var t;null===(t=this.socket)||void 0===t||t.emit("client-name-sent",e)},sendMessage:function(e){var t;null===(t=this.socket)||void 0===t||t.emit("client-message-sent",e)},typeMessage:function(){var e;null===(e=this.socket)||void 0===e||e.emit("client-typed")}},b={messages:[],typingUsers:[]},f=n(1);var h=function(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e.chat.messages})),n=Object(u.c)((function(e){return e.chat.typingUsers})),c=Object(s.useState)(""),i=Object(o.a)(c,2),r=i[0],a=i[1],l=Object(s.useState)("Alex"),d=Object(o.a)(l,2),b=d[0],h=d[1],g=Object(s.useState)(!0),O=Object(o.a)(g,2),v=O[0],p=O[1],m=Object(s.useState)(0),x=Object(o.a)(m,2),y=x[0],k=x[1];Object(s.useEffect)((function(){return e((function(e){j.createConnection(),j.subscribe((function(t){e(function(e){return{type:"messages-received",messages:e}}(t))}),(function(t){e(function(e){return{type:"new-message-received",message:e}}(t))}),(function(t){e(function(e){return{type:"typing-user-added",user:e}}(t))}))})),function(){e((function(e){j.destroyConnection()}))}}),[]),Object(s.useEffect)((function(){var e;v&&(null===(e=C.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))}),[t]);var C=Object(s.useRef)(null);return Object(f.jsxs)("div",{className:"App",children:["\u041c\u043e\u0451 \u0438\u043c\u044f: ",b,Object(f.jsxs)("div",{children:[Object(f.jsxs)("div",{style:{border:"1px solid",padding:"20px",width:"300px",height:"300px",overflow:"scroll"},onScroll:function(e){var t=e.currentTarget,n=t.scrollHeight-t.clientHeight;t.scrollTop>y&&Math.abs(n-t.scrollTop)<10?p(!0):p(!1),k(t.scrollTop)},children:[t.map((function(e){return Object(f.jsxs)("div",{children:[Object(f.jsxs)("b",{children:[e.user.name,":"]})," ",e.message,Object(f.jsx)("hr",{})]},e.id)})),n.map((function(e){return Object(f.jsxs)("div",{children:[Object(f.jsxs)("b",{children:[e.name,":"]})," ...",Object(f.jsx)("hr",{})]},e.id)})),Object(f.jsx)("div",{ref:C})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("input",{value:b,onChange:function(e){h(e.currentTarget.value)}}),Object(f.jsx)("button",{onClick:function(){e(function(e){return function(t){j.sendName(e)}}(b)),h("")},children:"send Name"})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("textarea",{value:r,onKeyPress:function(){e((function(e){j.typeMessage()}))},onChange:function(e){a(e.currentTarget.value)}}),Object(f.jsx)("button",{onClick:function(){e(function(e){return function(t){j.sendMessage(e)}}(r)),a("")},children:"send"})]})]})]})},g=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,90)).then((function(t){var n=t.getCLS,s=t.getFID,c=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),s(e),c(e),i(e),r(e)}))},O=n(21),v=n(46),p=Object(O.b)({chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"messages-received":return Object(l.a)(Object(l.a)({},e),{},{messages:t.messages});case"new-message-received":return Object(l.a)(Object(l.a)({},e),{},{messages:[].concat(Object(a.a)(e.messages),[t.message]),typingUsers:e.typingUsers.filter((function(e){return e.id!==t.message.user.id}))});case"typing-user-added":return Object(l.a)(Object(l.a)({},e),{},{typingUsers:[].concat(Object(a.a)(e.typingUsers.filter((function(e){return e.id!==t.user.id}))),[t.user])});default:return e}}}),m=Object(O.c)(p,Object(O.a)(v.a));r.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(u.a,{store:m,children:Object(f.jsx)(h,{})})}),document.getElementById("root")),g()}},[[89,1,2]]]);
//# sourceMappingURL=main.7d513d60.chunk.js.map