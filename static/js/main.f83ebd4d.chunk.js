(this["webpackJsonpsocket-chat"]=this["webpackJsonpsocket-chat"]||[]).push([[0],{10:function(e,t,n){e.exports={App:"App_App__yULup",chatBlock:"App_chatBlock__2W8_u",chatWrap:"App_chatWrap__1le8o",sendName:"App_sendName__3tRGS",sendMessage:"App_sendMessage__3K_iW"}},52:function(e,t,n){},89:function(e,t,n){"use strict";n.r(t);var s=n(0),c=n.n(s),i=n(20),a=n.n(i),r=(n(52),n(17)),o=n(10),u=n.n(o),l=n(9),d=n(32),j=n(6),b=n(46),h={socket:null,createConnection:function(){this.socket=Object(b.io)("https://fast-brushlands-44568.herokuapp.com/")},subscribe:function(e,t,n){var s,c,i;null===(s=this.socket)||void 0===s||s.on("init-messages-published",e),null===(c=this.socket)||void 0===c||c.on("new-message-sent",t),null===(i=this.socket)||void 0===i||i.on("user-typing",n)},destroyConnection:function(){var e;null===(e=this.socket)||void 0===e||e.disconnect(),this.socket=null},sendName:function(e){var t;null===(t=this.socket)||void 0===t||t.emit("client-name-sent",e)},sendMessage:function(e){var t;null===(t=this.socket)||void 0===t||t.emit("client-message-sent",e)},typeMessage:function(){var e;null===(e=this.socket)||void 0===e||e.emit("client-typed")}},f={messages:[],typingUsers:[]},p=n(1);var g=function(){var e=Object(l.b)(),t=Object(l.c)((function(e){return e.chat.messages})),n=Object(l.c)((function(e){return e.chat.typingUsers})),c=Object(s.useState)(""),i=Object(r.a)(c,2),a=i[0],o=i[1],d=Object(s.useState)("Alex"),j=Object(r.a)(d,2),b=j[0],f=j[1],g=Object(s.useState)(!0),O=Object(r.a)(g,2),m=O[0],v=O[1],x=Object(s.useState)(0),y=Object(r.a)(x,2),k=y[0],_=y[1];Object(s.useEffect)((function(){return e((function(e){h.createConnection(),h.subscribe((function(t){e(function(e){return{type:"messages-received",messages:e}}(t))}),(function(t){e(function(e){return{type:"new-message-received",message:e}}(t))}),(function(t){e(function(e){return{type:"typing-user-added",user:e}}(t))}))})),function(){e((function(e){h.destroyConnection()}))}}),[]),Object(s.useEffect)((function(){var e;m&&(null===(e=C.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))}),[t]);var C=Object(s.useRef)(null);return Object(p.jsx)("div",{className:u.a.App,children:Object(p.jsxs)("div",{className:u.a.chatBlock,children:[Object(p.jsxs)("div",{className:u.a.chatWrap,onScroll:function(e){var t=e.currentTarget,n=t.scrollHeight-t.clientHeight;t.scrollTop>k&&Math.abs(n-t.scrollTop)<10?v(!0):v(!1),_(t.scrollTop)},children:[t.map((function(e){return Object(p.jsxs)("div",{children:[Object(p.jsxs)("b",{children:[e.user.name,":"]})," ",e.message,Object(p.jsx)("hr",{})]},e.id)})),n.map((function(e){return Object(p.jsxs)("div",{children:[Object(p.jsxs)("b",{children:[e.name,":"]})," ...",Object(p.jsx)("hr",{})]},e.id)})),Object(p.jsx)("div",{ref:C})]}),Object(p.jsxs)("div",{className:u.a.sendName,children:[Object(p.jsx)("input",{value:b,onChange:function(e){f(e.currentTarget.value)}}),Object(p.jsx)("button",{onClick:function(){e(function(e){return function(t){h.sendName(e)}}(b)),f("")},children:"Send Name"})]}),Object(p.jsxs)("div",{className:u.a.sendMessage,children:[Object(p.jsx)("textarea",{value:a,onKeyPress:function(){e((function(e){h.typeMessage()}))},onChange:function(e){o(e.currentTarget.value)}}),Object(p.jsx)("button",{onClick:function(){e(function(e){return function(t){h.sendMessage(e)}}(a)),o("")},children:"Send message"})]})]})})},O=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,90)).then((function(t){var n=t.getCLS,s=t.getFID,c=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),s(e),c(e),i(e),a(e)}))},m=n(22),v=n(47),x=Object(m.b)({chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"messages-received":return Object(j.a)(Object(j.a)({},e),{},{messages:t.messages});case"new-message-received":return Object(j.a)(Object(j.a)({},e),{},{messages:[].concat(Object(d.a)(e.messages),[t.message]),typingUsers:e.typingUsers.filter((function(e){return e.id!==t.message.user.id}))});case"typing-user-added":return Object(j.a)(Object(j.a)({},e),{},{typingUsers:[].concat(Object(d.a)(e.typingUsers.filter((function(e){return e.id!==t.user.id}))),[t.user])});default:return e}}}),y=Object(m.c)(x,Object(m.a)(v.a));a.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(l.a,{store:y,children:Object(p.jsx)(g,{})})}),document.getElementById("root")),O()}},[[89,1,2]]]);
//# sourceMappingURL=main.f83ebd4d.chunk.js.map